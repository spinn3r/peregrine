#!/bin/sh

# run perf-stat but the all the options we need

EVENTS=cache-misses,cache-references,instructions,cycles,CPU-migrations,page-faults,stalled-cycles-frontend,stalled-cycles-backend

EVENTS=$EVENTS,L1-dcache-loads,L1-dcache-load-misses,L1-dcache-stores,L1-dcache-store-misses,L1-dcache-prefetches,L1-dcache-prefetch-misses
EVENTS=$EVENTS,L1-icache-loads,L1-icache-load-misses,L1-icache-prefetches,L1-icache-prefetch-misses
EVENTS=$EVENTS,LLC-loads,LLC-load-misses,LLC-stores,LLC-store-misses,LLC-prefetches,LLC-prefetch-misses

export LC_NUMERIC=en_US.UTF8 

/usr/local/bin/perf stat -a -B -e $EVENTS $@