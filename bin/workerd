#!/bin/sh

# This option specifies the maximum total size of java.nio (New I/O package)
# direct buffer allocations.

#ulimit -n 32768
#ulimit -l unlimited

./bin/jexec peregrine.worker.WaitForDaemon 2> /dev/null $@ 
result=$?

if [ "$result" = "0" ]; then
    exit 0
fi

./bin/jexec peregrine.worker.Main $@ < /dev/null > /dev/null 2> /dev/null &
pid=$!

./bin/jexec peregrine.worker.WaitForDaemon --pid=$pid $@ 2> /dev/null 
result=$?

exit $result
